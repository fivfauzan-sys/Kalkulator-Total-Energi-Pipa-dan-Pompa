<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Audit Energi Pipa Pro - Dual Method</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; padding: 20px; color: #333; }
        .container { max-width: 1100px; margin: auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        h2 { color: #1a73e8; text-align: center; border-bottom: 2px solid #eee; padding-bottom: 15px; }
        .section-title { background: #e8f0fe; color: #1a73e8; padding: 10px 15px; border-radius: 6px; margin: 20px 0 10px 0; font-weight: bold; font-size: 0.9em; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .input-box { display: flex; flex-direction: column; }
        label { font-size: 0.8em; font-weight: bold; margin-bottom: 5px; color: #666; }
        input, select { padding: 12px; border: 1px solid #dadce0; border-radius: 8px; font-size: 14px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.85em; }
        th, td { border: 1px solid #eee; padding: 10px; text-align: center; }
        th { background: #f8f9fa; }
        .result-card { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin-top: 25px; }
        .method-box { padding: 20px; border-radius: 12px; border: 1px solid #e0e0e0; background: #fff; }
        .highlight { font-size: 1.6em; font-weight: bold; color: #1a73e8; display: block; margin: 5px 0; }
        .status-tag { padding: 8px; border-radius: 6px; font-weight: bold; text-align: center; font-size: 0.85em; margin-top: 10px; }
        .safe { background: #e6f4ea; color: #1e8e3e; }
        .danger { background: #fce8e6; color: #d93025; }
        .info-sub { font-size: 0.8em; color: #666; line-height: 1.8; margin-top: 10px; border-top: 1px dashed #ccc; padding-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h2>üìä Audit Energi: Hazen-Williams vs Darcy-Weisbach</h2>

    <div class="section-title">‚öôÔ∏è DATA INPUT & MATERIAL</div>
    <div class="grid">
        <div class="input-box">
            <label>Pilih Material:</label>
            <select id="material_select" onchange="updateMaterial()">
                <option value="baja" selected>Baja (Steel)</option>
                <option value="hdpe">HDPE / PVC</option>
                <option value="gi">GI (Galvanis)</option>
                <option value="castiron">Cast Iron</option>
            </select>
        </div>
        <div class="input-box"><label>Debit (LPS):</label><input type="number" id="Q_lps" value="250" oninput="calculate()"></div>
        <div class="input-box"><label>Diameter (m):</label><input type="number" id="D" value="0.40" step="0.01" oninput="calculate()"></div>
        <div class="input-box"><label>Panjang (m):</label><input type="number" id="L" value="190.6" oninput="calculate()"></div>
    </div>

    <div class="grid">
        <div class="input-box"><label>Koef. H-W (C):</label><input type="number" id="C" value="100" readonly style="background:#f9f9f9"></div>
        <div class="input-box"><label>Kekasaran Œµ (m):</label><input type="number" id="eps" value="0.000045" step="0.000001" oninput="calculate()"></div>
        <div class="input-box"><label>EL. LWL (m):</label><input type="number" id="el_lwl" value="29.09" oninput="calculate()"></div>
        <div class="input-box"><label>EL. Outlet (m):</label><input type="number" id="el_out" value="38.17" oninput="calculate()"></div>
    </div>

    <div class="section-title">üîß FITTING & MINOR LOSSES (K-FACTOR)</div>
    <table>
        <thead><tr><th>Fitting</th><th>Koef (K)</th><th>Jumlah</th><th>Total K</th></tr></thead>
        <tbody id="fitting-body"></tbody>
    </table>

    <div class="result-card">
        <div class="method-box" style="border-top: 5px solid #1a73e8;">
            <label>HASIL HAZEN-WILLIAMS</label>
            <span class="highlight" id="total_hw">0.00 m</span>
            <div id="status_hw" class="status-tag safe">Energi Terpenuhi</div>
            <div class="info-sub">
                Kecepatan: <b id="v_hw">0.00 m/s</b><br>
                Major Losses ($H_f$): <b id="hf_hw">0.00 m</b><br>
                Minor Losses ($H_m$): <b id="hm_hw">0.00 m</b><br>
                Selisih Head Statis: <b id="hs_hw">0.00 m</b>
            </div>
        </div>

        <div class="method-box" style="border-top: 5px solid #1e8e3e;">
            <label>HASIL DARCY-WEISBACH</label>
            <span class="highlight" id="total_dw" style="color:#1e8e3e">0.00 m</span>
            <div id="status_dw" class="status-tag safe">Energi Terpenuhi</div>
            <div class="info-sub">
                <b>Reynolds Number:</b> <span id="re_val">0</span> (<span id="re_cat">-</span>)<br>
                <b>Faktor Gesek (f):</b> <span id="f_val">0.000</span><br>
                Major Losses ($H_f$): <b id="hf_dw">0.00 m</b><br>
                Total Energi: <b id="total_dw_val">0.00 m</b>
            </div>
        </div>
    </div>
</div>

<script>
const materialData = {
    hdpe: { c: 150, eps: 0.0000015 },
    baja: { c: 100, eps: 0.000045 },
    gi: { c: 100, eps: 0.0005 },
    castiron: { c: 83, eps: 0.00026 }
};

const fittings = [
    { name: 'Check Valve', k: 2, qty: 1 },
    { name: 'Air Release Valve', k: 0.8, qty: 1 },
    { name: 'Elbow 90¬∞', k: 0.9, qty: 1 },
    { name: 'Elbow 45¬∞', k: 0.4, qty: 1 },
    { name: 'Flange per 6m', k: 0.05, qty: 31 }
];

function updateMaterial() {
    const mat = document.getElementById('material_select').value;
    document.getElementById('C').value = materialData[mat].c;
    document.getElementById('eps').value = materialData[mat].eps;
    calculate();
}

function calculate() {
    const L = parseFloat(document.getElementById('L').value) || 0;
    const D = parseFloat(document.getElementById('D').value) || 0.1;
    const Q = (parseFloat(document.getElementById('Q_lps').value) || 0) / 1000;
    const C = parseFloat(document.getElementById('C').value) || 100;
    const eps = parseFloat(document.getElementById('eps').value) || 0;
    const el_lwl = parseFloat(document.getElementById('el_lwl').value) || 0;
    const el_out = parseFloat(document.getElementById('el_out').value) || 0;
    const Hp = 15; // Head Pompa
    const g = 9.81;
    const nu = 0.000001; // Viskositas

    // 1. Kecepatan
    const v = Q / (0.25 * Math.PI * Math.pow(D, 2));

    // 2. Minor Losses
    const kt = fittings.reduce((acc, f) => acc + (f.k * f.qty), 0);
    const hm = kt * (Math.pow(v, 2) / (2 * g));

    // 3. HAZEN-WILLIAMS
    const hf_hw = 10.67